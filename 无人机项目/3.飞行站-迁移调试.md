## rk3588s配置环境

下载镜像，烧录到SD卡，
```
$ lsb_release -a 
Distributor ID: Ubuntu
Description:    Ubuntu 20.04.6 LTS
Release:        20.04
Codename:       focal

$ uname -a
Linux orangepi5b 6.1.43-rockchip-rk3588 #1.0.10 SMP Thu Jul  4 01:52:00 CST 2024 aarch64 aarch64 aarch64 GNU/Linux

版本 Ubuntu20.04 focal 6.1.43-rockchip-rk3588(官方版本)
```

## 0.安装ros2

[Foxy ROS2安装](Foxy%20ROS2安装.md)

## 1. 安装nomachine？ 最好安装一份，容易查找ip地址



## 2. 模块包安装
```bash
sudo apt install python3-pip  -y
sudo pip3 install python-periphery # GPIO驱动库
sudo pip3 install pyserial # 串口通信

sudo apt-get install  python3-dev -y


## opencv模块  cv_bridge模块！
# sudo apt-get install -y ros-foxy-cv-bridge # cv-bridge在 ros2 cli默认不装，自己手动装上

# opencv会被上述依赖，自动安装，不需要特意指定 sudo apt-get install -y python3-opencv  # opencv

sudo apt-get install -y python3-numpy   # numpy

pip3 install torch==1.13.0
pip3 install numpy==1.24.4
# sudo pip3 install pyrealsense2  # t265 传感器模块 # 这个默认的不可以，需要从源码构建！建议v2.51.1
```

```bash
sudo pip3 install -y rknn_toolkit_lite2-x.y.z-cp38-cp38-linux_aarch64.whl 

# rknn-lite 图像推理
# 这个也可以，会默认匹配当前python版本，但最好指定版本sudo pip3 install   rknn-toolkit-lite2 -y # 当然，这个包也可以从github下载，本地安装

这里下载
https://github.com/rockchip-linux/rknn-toolkit2/tree/master/rknpu2/runtime/Linux/librknn_api/aarch64

# 如果遇到 无法加载rknn model v6版本模型, 更新 librknnrt.so 动态库，
https://github.com/airockchip/rknn-toolkit2/blob/master/rknpu2/runtime/Linux/librknn_api/aarch64 # 把最新的librknnrt.so下载下来

 sudo cp /usr/lib/librknnrt.so /usr/lib/librknnrt.so.backup
 sudo cp librknnrt.so /usr/lib/librknnrt.so
```

/usr/lib$ ls librk*
cp  ./so/*  /usr/lib/

/usr/local/lib/python3.8/dist-packages

1. /media/focal/rootfs/usr/local/lib/python3.8/dist-packages   应该是  torch-1.13.0.dist-info   
2. /media/focal/rootfs/usr/local/lib/python3.8/dist-packages   应该是  numpy-1.24.4   
```
pip3 show numpy torch
pip3 install torch==1.13.0
pip3 install numpy==1.24.4
```

 /home/orangepi/.local/lib/python3.8/site-packages/torch/lib/../../torch.libs/libgomp-d22c30c5.so.1.0.0

错误：OSError: /home/orangepi/.local/lib/python3.8/site-packages/torch/lib/../../torch.libs/libgomp-d22c30c5.so.1.0.0: cannot allocate memory in static TLS block

解决方案：echo 'export LD_PRELOAD=/home/orangepi/.local/lib/python3.8/site-packages/torch/lib/../../torch.libs/libgomp-d22c30c5.so.1.0.0:$LD_PRELOAD' >> ~/.bashrc && source ~/.bashrc


测试一下 opencv 和 cv_bridge的是否可以使用
```python
import cv2 # 先导入cv2,再导入cv_bridge！
from cv_bridge import CvBridge
```
 
其他
```bash
# 添加pip3安装的一些包，到环境变量，解决warning
echo 'export PATH=/home/orangepi/.local/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# >> 表示追加写入， > 表示覆盖写入（千万别覆盖写入）
```
---
