一般是默认安装的 pyrealsense2 版本太新，移除了对t265的支持。
需要换装 旧版的包，如 v2.51.1 版本的 librealsense 驱动库 可以正常使用。

---
## 安装过程
```bash
#0）获取 v2.51.1 版本的 librealsense 驱动库(必须)
git clone -b v2.51.1 https://github.com/IntelRealSense/librealsense.git  
 

#1）安装依赖包
sudo apt-get install libudev-dev pkg-config libgtk-3-dev
sudo apt-get install libusb-1.0-0-dev pkg-config
sudo apt-get install libglfw3-dev
sudo apt-get install libssl-dev

#2）安装权限脚本
cd librealsense
sudo cp config/99-realsense-libusb.rules /etc/udev/rules.d/
sudo udevadm control --reload-rules && udevadm trigger 
 
#3）编译
mkdir build
cd build
cmake ../ -DBUILD_EXAMPLES=true -DBUILD_PYTHON_BINDINGS:bool=true -DPYTHON_EXECUTABLE=$(which python3)
make 
sudo make install

#4）使用t265驱动，查看摄像头数据
realsense-viewer

#5)卸载
#dpkg -l | grep "realsense" | cut -d " " -f 3 | xargs sudo dpkg --purg

#————————————————
#版权声明：本文为CSDN博主「YOULANSHENGMENG」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
#原文链接：https://blog.csdn.net/YOULANSHENGMENG/article/details/129358380
```

留意一下安装日志，这里python的pyrealsense2库包，是默认安装在了`/usr/lib/python3.8/site-packages/pyrealsense2`。

在此路径下执行：
```python
python3 -c "import pyrealsense2 as rs; print(rs.__version__)"
```
应该可以正常输出 v2.51.1 
表明t265驱动包编译安装正常。
 
##  安装之后的实验现象：

由于udev规则重新加载了，如果读不到t265数据，请重新插拔一次t265接口，让机器识别到。

任意终端执行，可以观察到如下界面弹出
```
realsense-viewer
```

3D数据图
![](assets/3.%20飞行端orangepi-安装t265驱动/file-20260104134836667.png)

2D数据图
![](assets/3.%20飞行端orangepi-安装t265驱动/file-20260104134836670.png)

## python读取t265传感器数据

上述过程已经将 c++/python的驱动库 编译并安装好了，现在需要我们测试编程读取t265传感器数据。

https://zhuanlan.zhihu.com/p/441905002 参考此博客指导，可以在之前git clone好的https://github.com/IntelRealSense/librealsense.git 下面找到python示例程序：

> _位置：librealsense/wrappers/python/examples/_

+ 获得位置信息：**t265_example.py**

```python
#!/usr/bin/python
# -*- coding: utf-8 -*-
## License: Apache 2.0. See LICENSE file in root directory.
## Copyright(c) 2019 Intel Corporation. All Rights Reserved.
​
#####################################################
##           librealsense T265 example             ##
#####################################################
​
# First import the library
import pyrealsense2 as rs
​
# Declare RealSense pipeline, encapsulating the actual device and sensors
pipe = rs.pipeline()
​
# Build config object and request pose data
cfg = rs.config()
cfg.enable_stream(rs.stream.pose)
​
# Start streaming with requested config
pipe.start(cfg)
​
try:
    for _ in range(50):
        # Wait for the next set of frames from the camera
        frames = pipe.wait_for_frames()
​
        # Fetch pose frame
        pose = frames.get_pose_frame()
        if pose:
            # Print some of the pose data to the terminal
            data = pose.get_pose_data()
            print("Frame #{}".format(pose.frame_number))
            print("Position: {}".format(data.translation))
            print("Velocity: {}".format(data.velocity))
            print("Acceleration: {}\n".format(data.acceleration))
​
finally:
    pipe.stop()
```

+ 获得姿态信息：**t265_rpy.py**

```python
#!/usr/bin/python
# -*- coding: utf-8 -*-
## License: Apache 2.0. See LICENSE file in root directory.
## Copyright(c) 2019 Intel Corporation. All Rights Reserved.
​
#####################################################
##           librealsense T265 rpy example         ##
#####################################################
​
# First import the library
import pyrealsense2 as rs
import math as m
​
# Declare RealSense pipeline, encapsulating the actual device and sensors
pipe = rs.pipeline()
​
# Build config object and request pose data
cfg = rs.config()
cfg.enable_stream(rs.stream.pose)
​
# Start streaming with requested config
pipe.start(cfg)
​
try:
    while (True):
        # Wait for the next set of frames from the camera
        frames = pipe.wait_for_frames()
​
        # Fetch pose frame
        pose = frames.get_pose_frame()
        if pose:
            # Print some of the pose data to the terminal
            data = pose.get_pose_data()
​
            # Euler angles from pose quaternion
            # See also https://github.com/IntelRealSense/librealsense/issues/5178#issuecomment-549795232
            # and https://github.com/IntelRealSense/librealsense/issues/5178#issuecomment-550217609
​
            w = data.rotation.w
            x = -data.rotation.z
            y = data.rotation.x
            z = -data.rotation.y
​
            pitch =  -m.asin(2.0 * (x*z - w*y)) * 180.0 / m.pi;
            roll  =  m.atan2(2.0 * (w*x + y*z), w*w - x*x - y*y + z*z) * 180.0 / m.pi;
            yaw   =  m.atan2(2.0 * (w*z + x*y), w*w + x*x - y*y - z*z) * 180.0 / m.pi;
            
            print("Frame #{}".format(pose.frame_number))
            print("RPY [deg]: Roll: {0:.7f}, Pitch: {1:.7f}, Yaw: {2:.7f}".format(roll, pitch, yaw))
​
​
finally:
    pipe.stop()
```

 
## 解决错误：python import pyrealsense2失败

留意一下安装日志，这里python的pyrealsense2库包，是默认安装在了`/usr/lib/python3.8/site-packages/pyrealsense2`。

查看一下日志，或者用这个看一下是否有 pyrealsense2 这个包：
```bash
 ls /usr/lib/python3.8/site-packages | grep pyreal
 ls /usr/local/lib/python3.8/dist-packages | grep pyreal
```


在 `/usr/lib/python3.8/site-packages/pyrealsense2` 路径下打开终端 执行：
```python
python3 -c "import pyrealsense2 as rs; print(rs.__version__)"
```
应该可以正常输出 v2.51.1 

其他路径下执行该指令，错误/失败：没有`pyrealsense2`， 或者是`rs.__version__`不存在

原因：这里的pyrealsense2是cpython package类型的动态库包，如果找不到或者导入失败:
+ 需要将 /usr/lib/python3.8/site-packages/pyrealsense2 目录添加到环境变量；
+ 或是将 /usr/lib/python3.8/site-packages/pyrealsense2 目录下的动态库复制到项目运行目录。

这里用**添加环境变量**的方式 修复错误：
+ 用户级path：

```bash
sudo echo 'export PYTHONPATH=$PYTHONPATH:/usr/lib/python3.8/site-packages/pyrealsense2' >> ~/.bashrc

cat ~/.bashrc  | grep pyrealsense2 
sudo source ~/.bashrc
```

+ root级path:
```bash
sudo echo 'export PYTHONPATH=$PYTHONPATH:/usr/lib/python3.8/site-packages/pyrealsense2' >> /root/.bashrc

cat ~/.bashrc  | grep pyrealsense2 
sudo source ~/.bashrc
```
 

参考这个cmake源码构建并安装：

https://github.com/realsenseai/librealsense/tree/development/wrappers/python#building-from-source
```
mkdir build
cd build
cmake ../ -DBUILD_PYTHON_BINDINGS:bool=true -DPYTHON_EXECUTABLE=$(which python3)
make -j4
sudo make install
```


```
检查 包版本
pip show  pyrealsense2
(可能不显示，因为该版本的包，是自己编译安装的，默认装在了/usr/lib/python3.8/site-packages/pyrealsense2，并非python默认的搜索路径) 

或是 python3 -c "import pyrealsense2 as rs; print(rs.__version__)"

现在使用的是 ：pyrealsense2 2.51.1 
```


```
export PYTHONPATH=$PYTHONPATH:/usr/lib/python3.8/site-packages/pyrealsense2

sudo echo 'export PYTHONPATH=$PYTHONPATH:/usr/lib/python3.8/site-packages/pyrealsense2' >> /root/.bashrc
source /root/.bashrc 
cat /root/.bashrc  | grep pyrealsense2

sudo echo 'export PYTHONPATH=$PYTHONPATH:/usr/lib/python3.8/site-packages/pyrealsense2' >> ~/.bashrc
source ~/.bashrc
cat ~/.bashrc | grep pyrealsense2

echo $PYTHONPATH

源路径 /usr/lib/python3.8/site-packages/pyrealsense2
或是： /usr/local/lib/python3.8/dist-packages
默认:/usr/lib/python3.8/site-packages 是默认的cmake安装路径，

需要安装在/usr/lib/python3/dist-packages
或是： /usr/local/lib/python3.8/dist-packages

